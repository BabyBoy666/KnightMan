/*! For license information please see WeaponPlugin.min.js.LICENSE.txt */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("WeaponPlugin",[],e):"object"==typeof exports?exports.WeaponPlugin=e():t.WeaponPlugin=e()}(self,(function(){return(()=>{var t=[(t,e,r)=>{"use strict";r.r(e),r.d(e,{Weapon:()=>i.default,Bullet:()=>s.default,consts:()=>l.default,events:()=>n.default,WeaponPlugin:()=>a.default});var i=r(1),s=r(66),l=r(67),n=r(68),a=r(70)},(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>o});r(2),r(64);var i=r(66),s=r(67),l=r(69),n=r(68);class a extends Phaser.Events.EventEmitter{constructor(t,e,r="",n="",a){super(),this.scene=void 0,this.debugPhysics=!1,this._bullets=void 0,this._autoExpandBulletsGroup=!1,this._autofire=!1,this._shots=0,this._fireLimit=0,this._fireRate=100,this._fireRateVariance=0,this._fireFrom=new Phaser.Geom.Rectangle(0,0,1,1),this._fireAngle=s.Angle.ANGLE_UP,this._bulletInheritSpriteSpeed=!1,this._bulletAnimation="",this._bulletFrameRandom=!1,this._bulletFrameCycle=!1,this._bulletWorldWrap=!1,this._bulletWorldWrapPadding=0,this._bulletAngleOffset=0,this._bulletAngleVariance=0,this._bulletSpeed=200,this._bulletSpeedVariance=0,this._bulletLifespan=0,this._bulletKillDistance=0,this._bulletGravity=new Phaser.Math.Vector2(0,0),this._bulletRotateToVelocity=!1,this._bulletKey=void 0,this._bulletFrame=void 0,this._bulletClass=i.default,this._bulletCollideWorldBounds=!1,this._bulletKillType=s.KillType.KILL_WORLD_BOUNDS,this._data={customBody:!1,width:0,height:0,offsetX:0,offsetY:0},this._bounds=new Phaser.Geom.Rectangle,this._bulletBounds=void 0,this._bulletFrames=[],this._bulletFrameIndex=0,this.anims={},this._trackedSprite=void 0,this._trackedPointer=void 0,this._multiFire=!1,this._hasFired=!1,this._trackRotation=!1,this._trackOffset=new Phaser.Math.Vector2,this._nextFire=0,this._tempNextFire=0,this._rotatedPoint=new Phaser.Math.Vector2,this.logLevel="warn",this.scene=t,this._bulletKey=r,this._bulletFrame=n,this._bulletBounds=this.scene.physics.world.bounds,(0,l.default)(this),this.createBullets(e,r,n,a)}get bullets(){return this._bullets}set bullets(t){this._bullets=t,(0,l.default)(this,"bullets")}get autoExpandBulletsGroup(){return this._autoExpandBulletsGroup}set autoExpandBulletsGroup(t){this._autoExpandBulletsGroup=t,(0,l.default)(this,"autoExpandBulletsGroup")}get autofire(){return this._autofire}set autofire(t){this._autofire=t,(0,l.default)(this,"autofire")}get shots(){return this._shots}set shots(t){this._shots=t,(0,l.default)(this,"shots")}get fireLimit(){return this._fireLimit}set fireLimit(t){this._fireLimit=t,(0,l.default)(this,"fireLimit")}get fireRate(){return this._fireRate}set fireRate(t){this._fireRate=t,(0,l.default)(this,"fireRate")}get fireRateVariance(){return this._fireRateVariance}set fireRateVariance(t){this._fireRateVariance=t,(0,l.default)(this,"fireRateVariance")}get fireFrom(){return this._fireFrom}set fireFrom(t){this._fireFrom=t,(0,l.default)(this,"fireFrom")}get fireAngle(){return this._fireAngle}set fireAngle(t){this._fireAngle=t,(0,l.default)(this,"fireAngle")}get bulletInheritSpriteSpeed(){return this._bulletInheritSpriteSpeed}set bulletInheritSpriteSpeed(t){this._bulletInheritSpriteSpeed=t,(0,l.default)(this,"bulletInheritSpriteSpeed")}get bulletAnimation(){return this._bulletAnimation}set bulletAnimation(t){this._bulletAnimation=t,(0,l.default)(this,"bulletAnimation")}get bulletFrameRandom(){return this._bulletFrameRandom}set bulletFrameRandom(t){this._bulletFrameRandom=t,(0,l.default)(this,"bulletFrameRandom")}get bulletFrameCycle(){return this._bulletFrameCycle}set bulletFrameCycle(t){this._bulletFrameCycle=t,(0,l.default)(this,"bulletFrameCycle")}get bulletWorldWrap(){return this._bulletWorldWrap}set bulletWorldWrap(t){this._bulletWorldWrap=t,(0,l.default)(this,"bulletWorldWrap")}get bulletWorldWrapPadding(){return this._bulletWorldWrapPadding}set bulletWorldWrapPadding(t){this._bulletWorldWrapPadding=t,(0,l.default)(this,"bulletWorldWrapPadding")}get bulletAngleOffset(){return this._bulletAngleOffset}set bulletAngleOffset(t){this._bulletAngleOffset=t,(0,l.default)(this,"bulletAngleOffset")}get bulletAngleVariance(){return this._bulletAngleVariance}set bulletAngleVariance(t){this._bulletAngleVariance=t,(0,l.default)(this,"bulletAngleVariance")}get bulletSpeed(){return this._bulletSpeed}set bulletSpeed(t){this._bulletSpeed=t,(0,l.default)(this,"bulletSpeed")}get bulletSpeedVariance(){return this._bulletSpeedVariance}set bulletSpeedVariance(t){this._bulletSpeedVariance=t,(0,l.default)(this,"bulletSpeedVariance")}get bulletLifespan(){return this._bulletLifespan}set bulletLifespan(t){this._bulletLifespan=t,(0,l.default)(this,"bulletLifespan")}get bulletKillDistance(){return this._bulletKillDistance}set bulletKillDistance(t){this._bulletKillDistance=t,(0,l.default)(this,"bulletKillDistance")}get bulletGravity(){return this._bulletGravity}set bulletGravity(t){this._bulletGravity=t,(0,l.default)(this,"bulletGravity")}get bulletRotateToVelocity(){return this._bulletRotateToVelocity}set bulletRotateToVelocity(t){this._bulletRotateToVelocity=t,(0,l.default)(this,"bulletRotateToVelocity")}get bulletKey(){return this._bulletKey}set bulletKey(t){this._bulletKey=t,(0,l.default)(this,"bulletKey")}get bulletFrame(){return this._bulletFrame}set bulletFrame(t){this._bulletFrame=t,(0,l.default)(this,"bulletFrame")}get bulletClass(){return this._bulletClass}set bulletClass(t){this._bulletClass=t,this.bullets&&(this.bullets.classType=this._bulletClass),(0,l.default)(this,"bulletClass")}get bulletCollideWorldBounds(){return this._bulletCollideWorldBounds}set bulletCollideWorldBounds(t){this._bulletCollideWorldBounds=t,this.bullets.children.each((e=>{e.body.collideWorldBounds=t,e.setData("bodyDirty",!1)})),(0,l.default)(this,"bulletCollideWorldBounds")}get bulletKillType(){return this._bulletKillType}set bulletKillType(t){switch(t){case s.KillType.KILL_STATIC_BOUNDS:case s.KillType.KILL_WEAPON_BOUNDS:this.bulletBounds=this.bounds;break;case s.KillType.KILL_CAMERA_BOUNDS:this.bulletBounds=this.scene.sys.cameras.main.getBounds();break;case s.KillType.KILL_WORLD_BOUNDS:this.bulletBounds=this.scene.physics.world.bounds}this._bulletKillType=t,(0,l.default)(this,"bulletKillType")}get bounds(){return this._bounds}set bounds(t){this._bounds=t,(0,l.default)(this,"bounds")}get bulletBounds(){return this._bulletBounds}set bulletBounds(t){this._bulletBounds=t,(0,l.default)(this,"bulletBounds")}get bulletFrames(){return this._bulletFrames}set bulletFrames(t){this._bulletFrames=t,(0,l.default)(this,"bulletFrames")}get bulletFrameIndex(){return this._bulletFrameIndex}set bulletFrameIndex(t){this._bulletFrameIndex=t,(0,l.default)(this,"bulletFrameIndex")}get trackedSprite(){return this._trackedSprite}set trackedSprite(t){this._trackedSprite=t,(0,l.default)(this,"trackedSprite")}get trackedPointer(){return this._trackedPointer}set trackedPointer(t){this._trackedPointer=t,(0,l.default)(this,"trackedPointer")}get multiFire(){return this._multiFire}set multiFire(t){this._multiFire=t,(0,l.default)(this,"multiFire")}get trackRotation(){return this._trackRotation}set trackRotation(t){this._trackRotation=t,(0,l.default)(this,"trackRotation")}get trackOffset(){return this._trackOffset}set trackOffset(t){this._trackOffset=t,(0,l.default)(this,"trackOffset")}get x(){return this.fireFrom.x}set x(t){this.fireFrom.x=t}get y(){return this.fireFrom.y}set y(t){this.fireFrom.y=t}createBullets(t=1,e,r,i,s){return s&&(this._bulletClass=s),this.bullets&&this.bullets.scene||(this.bullets=this.scene.add.group({classType:this._bulletClass,maxSize:t,runChildUpdate:!0})),0!==t&&(-1===t&&(this.autoExpandBulletsGroup=!0,t=1),this.bullets.createMultiple({key:e,frame:r,repeat:t,active:!1,visible:!1}),this.bullets.children.each((t=>{t.setData("bulletManager",this)})),"string"==typeof e&&(this.bulletKey=e),"string"==typeof r&&this.bulletFrame,i&&i.addMultiple(this.bullets.children.entries)),this}forEach(t,e,...r){return this.bullets.children.each((i=>{i.active&&t.call(e,i,r)})),this}pauseAll(){return this.bullets.children.each((t=>{t.body.enable=!1;const e=t.getData("timeEvent");void 0!==e&&(e.paused=!0)}),this),this}resumeAll(){return this.bullets.children.each((t=>{t.body.enable=!0;const e=t.getData("timeEvent");void 0!==e&&(e.paused=!1)}),this),this}killAll(){return this.bullets.children.each((t=>{t.active&&t.kill(),t.body.enable=!0})),this}resetShots(t){return this.shots=0,void 0!==t&&(this.fireLimit=t),this}trackSprite(t,e=0,r=0,i=!1){return this.trackedPointer=void 0,this.trackedSprite=t,this.trackRotation=i,this.trackOffset.set(e,r),this}trackPointer(t,e=0,r=0){return void 0===t&&this.scene.input&&(t=this.scene.input.activePointer),this.trackedPointer=t,this.trackedSprite=void 0,this.trackRotation=!1,this.trackOffset.set(e,r),this}fireMany(t,e){this.multiFire=!0;const r=[];return e||this.trackedSprite||this.trackedPointer?t.forEach((t=>{const i=this.fire(e,null,null,t.x,t.y);i&&r.push(i)})):t.forEach((t=>{const e=this.fire(t);e&&r.push(e)})),r}fireOffset(t=0,e=0){return this.fire(null,null,null,t,e)}fireAtPointer(t){var e,r;return void 0===t&&this.scene.input&&(t=this.scene.input.activePointer),this.fire(null,null===(e=t)||void 0===e?void 0:e.x,null===(r=t)||void 0===r?void 0:r.y)}fireAtSprite(t){return this.fire(null,null==t?void 0:t.x,null==t?void 0:t.y)}fireAtXY(t,e){return this.fire(null,t,e)}fire(t,e,r,i=0,l=0){var a;if(this.scene.time.now<this._nextFire||this.fireLimit>0&&this.shots===this.fireLimit)return;let o=this.bulletSpeed;0!==this.bulletSpeedVariance&&(o+=Phaser.Math.Between(-this.bulletSpeedVariance,this.bulletSpeedVariance)),t?this.updateFireFrom(t.x,t.y):this.trackedSprite&&"number"==typeof this.trackedSprite.rotation?(this.trackRotation?(this._rotatedPoint.set(this.trackedSprite.x+this.trackOffset.x,this.trackedSprite.y+this.trackOffset.y),Phaser.Math.RotateAround(this._rotatedPoint,this.trackedSprite.x,this.trackedSprite.y,this.trackedSprite.rotation),this.updateFireFrom(this._rotatedPoint.x,this._rotatedPoint.y)):this.updateFireFrom(this.trackedSprite.x,this.trackedSprite.y),this.bulletInheritSpriteSpeed&&this.trackedSprite.body&&(o+=this.trackedSprite.body.speed)):this.trackedPointer&&this.updateFireFrom(this.trackedPointer.x,this.trackedPointer.y),this.fireFrom.x+=i,this.fireFrom.y+=l;const u=this.fireFrom.width>1?this.fireFrom.x+Math.random()*this.fireFrom.width:this.fireFrom.x,h=this.fireFrom.height>1?this.fireFrom.y+Math.random()*this.fireFrom.height:this.fireFrom.y;let c="number"==typeof(null===(a=this.trackedSprite)||void 0===a?void 0:a.angle)&&this.trackRotation?this.trackedSprite.angle:this.fireAngle;"number"==typeof e&&"number"==typeof r&&(c=Phaser.Math.RadToDeg(Math.atan2(r-h,e-u))),0!==this.bulletAngleVariance&&(c+=Phaser.Math.Between(-this.bulletAngleVariance,this.bulletAngleVariance));let d,f=0,p=0;var b;(0===c||180===c?f=Math.cos(Phaser.Math.DegToRad(c))*o:(90===c||270===c||(f=Math.cos(Phaser.Math.DegToRad(c))*o),p=Math.sin(Phaser.Math.DegToRad(c))*o),this.autoExpandBulletsGroup)?(d=this.bullets.getFirstDead(!0,u,h,this.bulletKey,this.bulletFrame),null===(b=d)||void 0===b||b.setData("bulletManager",this)):d=this.bullets.getFirstDead(!1);if(void 0!==d){if(d.prepare(u,h),d.setData({fromX:u,fromY:h,killType:this.bulletKillType,killDistance:this.bulletKillDistance,rotateToVelocity:this.bulletRotateToVelocity}),this.bulletKillType===s.KillType.KILL_LIFESPAN&&(d.setData("timeEvent",this.scene.time.addEvent({delay:this.bulletLifespan,callback:d.kill,callbackScope:d})),d.lifespan=this.bulletLifespan),d.angle=c+this.bulletAngleOffset,this.bulletAnimation)d.anims.play(this.bulletAnimation);else if(this.bulletFrameCycle)this.bulletFrameIndex>=this.bulletFrames.length&&(this.bulletFrameIndex=0),d.setTexture(this.bulletKey,this.bulletFrameIndex),this.bulletFrameIndex++;else if(this.bulletFrameRandom){const t=Math.floor(Math.random()*this.bulletFrames.length);d.setTexture(this.bulletKey,t)}d.getData("bodyDirty")&&(this._data.customBody&&(d.body.setSize(this._data.width,this._data.height),d.body.setOffset(this._data.offsetX,this._data.offsetY)),d.body.collideWorldBounds=this.bulletCollideWorldBounds,d.setData("bodyDirty",!1)),d.body.setVelocity(f,p),d.body.setGravity(this.bulletGravity.x,this.bulletGravity.y);let t=0;if(0!==this.bulletSpeedVariance){let e=this.fireRate;e+=Phaser.Math.Between(-this.fireRateVariance,this.fireRateVariance),e<0&&(e=0),t=this.scene.time.now+e}else t=this.scene.time.now+this.fireRate;this.multiFire?this._hasFired||(this._hasFired=!0,this._tempNextFire=t,this.shots++):(this._nextFire=t,this.shots++),this.emit(n.WEAPON_FIRE,d,this,o),this.fireLimit>0&&this.shots===this.fireLimit&&this.emit(n.WEAPON_FIRE_LIMIT,this,this.fireLimit)}return d}updateFireFrom(t,e){this.fireFrom.width>1?Phaser.Geom.Rectangle.CenterOn(this.fireFrom,t+this.trackOffset.x,e+this.trackOffset.y):(this.fireFrom.x=t+this.trackOffset.x,this.fireFrom.y=e+this.trackOffset.y)}setBulletBodyOffset(t,e,r=0,i=0){return this._data.customBody=!0,this._data.width=t,this._data.height=e,this._data.offsetX=r,this._data.offsetY=i,this.bullets.children.each((s=>{s.body.setSize(t,e),s.body.setOffset(r,i),s.setData("bodyDirty",!1)})),this}setBulletFrames(t,e,r=s.FrameType.BULLET_FRAME_STABLE){return("number"!=typeof r||r<s.FrameType.BULLET_FRAME_STABLE||r>s.FrameType.BULLET_FRAME_RANDOM)&&(0,l.log)(`Invalid bullet frame selection method specified: ${r}`,this.logLevel),t>e&&(0,l.log)(`min frame (${t}) must be <= max frame (${e})`,this.logLevel),this.bulletFrames=Phaser.Utils.Array.NumberArray(t,e),this.bulletFrameIndex=0,this.bulletFrameCycle=r===s.FrameType.BULLET_FRAME_CYCLE,this.bulletFrameRandom=r===s.FrameType.BULLET_FRAME_RANDOM,this}addBulletAnimation(t,e,r=60,i=0){return this.scene.sys.anims.exists(t)||(this.scene.sys.anims.create({key:t,frames:e,frameRate:r,repeat:i}),this.anims[t]=this.scene.sys.anims.get(t)),this.bulletAnimation=t,this}update(){this._bulletKillType===s.KillType.KILL_WEAPON_BOUNDS&&(this.trackedSprite?Phaser.Geom.Rectangle.CenterOn(this.bounds,this.trackedSprite.x,this.trackedSprite.y):this.trackedPointer&&Phaser.Geom.Rectangle.CenterOn(this.bounds,this.trackedPointer.x,this.trackedPointer.y)),this.autofire&&this.fire()}postRender(){this.multiFire&&this._hasFired&&(this._hasFired=!1,this._nextFire=this._tempNextFire)}destroy(){this.scene=void 0,this.bullets.destroy(!0)}}const o=a},(t,e,r)=>{"use strict";var i=r(3),s=r(8),l=r(42),n=r(43),a=r(46),o="Array Iterator",u=n.set,h=n.getterFor(o);t.exports=a(Array,"Array",(function(t,e){u(this,{type:o,target:i(t),index:0,kind:e})}),(function(){var t=h(this),e=t.target,r=t.kind,i=t.index++;return!e||i>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:i,done:!1}:"values"==r?{value:e[i],done:!1}:{value:[i,e[i]],done:!1}}),"values"),l.Arguments=l.Array,s("keys"),s("values"),s("entries")},(t,e,r)=>{var i=r(4),s=r(7);t.exports=function(t){return i(s(t))}},(t,e,r)=>{var i=r(5),s=r(6),l="".split;t.exports=i((function(){return!Object("z").propertyIsEnumerable(0)}))?function(t){return"String"==s(t)?l.call(t,""):Object(t)}:Object},t=>{t.exports=function(t){try{return!!t()}catch(e){return!0}}},t=>{var e={}.toString;t.exports=function(t){return e.call(t).slice(8,-1)}},t=>{t.exports=function(t){if(null==t)throw TypeError("Can't call method on "+t);return t}},(t,e,r)=>{var i=r(9),s=r(28),l=r(17),n=i("unscopables"),a=Array.prototype;null==a[n]&&l.f(a,n,{configurable:!0,value:s(null)}),t.exports=function(t){a[n][t]=!0}},(t,e,r)=>{var i=r(10),s=r(11),l=r(24),n=r(25),a=r(26),o=r(27),u=s("wks"),h=i.Symbol,c=o?h:h&&h.withoutSetter||n;t.exports=function(t){return l(u,t)||(a&&l(h,t)?u[t]=h[t]:u[t]=c("Symbol."+t)),u[t]}},(t,e,r)=>{var i=function(t){return t&&t.Math==Math&&t};t.exports=i("object"==typeof globalThis&&globalThis)||i("object"==typeof window&&window)||i("object"==typeof self&&self)||i("object"==typeof r.g&&r.g)||function(){return this}()||Function("return this")()},(t,e,r)=>{var i=r(12),s=r(13);(t.exports=function(t,e){return s[t]||(s[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.8.3",mode:i?"pure":"global",copyright:"Â© 2021 Denis Pushkarev (zloirock.ru)"})},t=>{t.exports=!1},(t,e,r)=>{var i=r(10),s=r(14),l="__core-js_shared__",n=i[l]||s(l,{});t.exports=n},(t,e,r)=>{var i=r(10),s=r(15);t.exports=function(t,e){try{s(i,t,e)}catch(r){i[t]=e}return e}},(t,e,r)=>{var i=r(16),s=r(17),l=r(23);t.exports=i?function(t,e,r){return s.f(t,e,l(1,r))}:function(t,e,r){return t[e]=r,t}},(t,e,r)=>{var i=r(5);t.exports=!i((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]}))},(t,e,r)=>{var i=r(16),s=r(18),l=r(21),n=r(22),a=Object.defineProperty;e.f=i?a:function(t,e,r){if(l(t),e=n(e,!0),l(r),s)try{return a(t,e,r)}catch(i){}if("get"in r||"set"in r)throw TypeError("Accessors not supported");return"value"in r&&(t[e]=r.value),t}},(t,e,r)=>{var i=r(16),s=r(5),l=r(19);t.exports=!i&&!s((function(){return 7!=Object.defineProperty(l("div"),"a",{get:function(){return 7}}).a}))},(t,e,r)=>{var i=r(10),s=r(20),l=i.document,n=s(l)&&s(l.createElement);t.exports=function(t){return n?l.createElement(t):{}}},t=>{t.exports=function(t){return"object"==typeof t?null!==t:"function"==typeof t}},(t,e,r)=>{var i=r(20);t.exports=function(t){if(!i(t))throw TypeError(String(t)+" is not an object");return t}},(t,e,r)=>{var i=r(20);t.exports=function(t,e){if(!i(t))return t;var r,s;if(e&&"function"==typeof(r=t.toString)&&!i(s=r.call(t)))return s;if("function"==typeof(r=t.valueOf)&&!i(s=r.call(t)))return s;if(!e&&"function"==typeof(r=t.toString)&&!i(s=r.call(t)))return s;throw TypeError("Can't convert object to primitive value")}},t=>{t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},t=>{var e={}.hasOwnProperty;t.exports=function(t,r){return e.call(t,r)}},t=>{var e=0,r=Math.random();t.exports=function(t){return"Symbol("+String(void 0===t?"":t)+")_"+(++e+r).toString(36)}},(t,e,r)=>{var i=r(5);t.exports=!!Object.getOwnPropertySymbols&&!i((function(){return!String(Symbol())}))},(t,e,r)=>{var i=r(26);t.exports=i&&!Symbol.sham&&"symbol"==typeof Symbol.iterator},(t,e,r)=>{var i,s=r(21),l=r(29),n=r(37),a=r(36),o=r(38),u=r(19),h=r(41),c=h("IE_PROTO"),d=function(){},f=function(t){return"<script>"+t+"</"+"script>"},p=function(){try{i=document.domain&&new ActiveXObject("htmlfile")}catch(s){}var t,e;p=i?function(t){t.write(f("")),t.close();var e=t.parentWindow.Object;return t=null,e}(i):((e=u("iframe")).style.display="none",o.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(f("document.F=Object")),t.close(),t.F);for(var r=n.length;r--;)delete p.prototype[n[r]];return p()};a[c]=!0,t.exports=Object.create||function(t,e){var r;return null!==t?(d.prototype=s(t),r=new d,d.prototype=null,r[c]=t):r=p(),void 0===e?r:l(r,e)}},(t,e,r)=>{var i=r(16),s=r(17),l=r(21),n=r(30);t.exports=i?Object.defineProperties:function(t,e){l(t);for(var r,i=n(e),a=i.length,o=0;a>o;)s.f(t,r=i[o++],e[r]);return t}},(t,e,r)=>{var i=r(31),s=r(37);t.exports=Object.keys||function(t){return i(t,s)}},(t,e,r)=>{var i=r(24),s=r(3),l=r(32).indexOf,n=r(36);t.exports=function(t,e){var r,a=s(t),o=0,u=[];for(r in a)!i(n,r)&&i(a,r)&&u.push(r);for(;e.length>o;)i(a,r=e[o++])&&(~l(u,r)||u.push(r));return u}},(t,e,r)=>{var i=r(3),s=r(33),l=r(35),n=function(t){return function(e,r,n){var a,o=i(e),u=s(o.length),h=l(n,u);if(t&&r!=r){for(;u>h;)if((a=o[h++])!=a)return!0}else for(;u>h;h++)if((t||h in o)&&o[h]===r)return t||h||0;return!t&&-1}};t.exports={includes:n(!0),indexOf:n(!1)}},(t,e,r)=>{var i=r(34),s=Math.min;t.exports=function(t){return t>0?s(i(t),9007199254740991):0}},t=>{var e=Math.ceil,r=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?r:e)(t)}},(t,e,r)=>{var i=r(34),s=Math.max,l=Math.min;t.exports=function(t,e){var r=i(t);return r<0?s(r+e,0):l(r,e)}},t=>{t.exports={}},t=>{t.exports=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]},(t,e,r)=>{var i=r(39);t.exports=i("document","documentElement")},(t,e,r)=>{var i=r(40),s=r(10),l=function(t){return"function"==typeof t?t:void 0};t.exports=function(t,e){return arguments.length<2?l(i[t])||l(s[t]):i[t]&&i[t][e]||s[t]&&s[t][e]}},(t,e,r)=>{var i=r(10);t.exports=i},(t,e,r)=>{var i=r(11),s=r(25),l=i("keys");t.exports=function(t){return l[t]||(l[t]=s(t))}},t=>{t.exports={}},(t,e,r)=>{var i,s,l,n=r(44),a=r(10),o=r(20),u=r(15),h=r(24),c=r(13),d=r(41),f=r(36),p=a.WeakMap;if(n){var b=c.state||(c.state=new p),y=b.get,_=b.has,m=b.set;i=function(t,e){return e.facade=t,m.call(b,t,e),e},s=function(t){return y.call(b,t)||{}},l=function(t){return _.call(b,t)}}else{var g=d("state");f[g]=!0,i=function(t,e){return e.facade=t,u(t,g,e),e},s=function(t){return h(t,g)?t[g]:{}},l=function(t){return h(t,g)}}t.exports={set:i,get:s,has:l,enforce:function(t){return l(t)?s(t):i(t,{})},getterFor:function(t){return function(e){var r;if(!o(e)||(r=s(e)).type!==t)throw TypeError("Incompatible receiver, "+t+" required");return r}}}},(t,e,r)=>{var i=r(10),s=r(45),l=i.WeakMap;t.exports="function"==typeof l&&/native code/.test(s(l))},(t,e,r)=>{var i=r(13),s=Function.toString;"function"!=typeof i.inspectSource&&(i.inspectSource=function(t){return s.call(t)}),t.exports=i.inspectSource},(t,e,r)=>{"use strict";var i=r(47),s=r(56),l=r(58),n=r(62),a=r(61),o=r(15),u=r(50),h=r(9),c=r(12),d=r(42),f=r(57),p=f.IteratorPrototype,b=f.BUGGY_SAFARI_ITERATORS,y=h("iterator"),_="keys",m="values",g="entries",v=function(){return this};t.exports=function(t,e,r,h,f,L,S){s(r,e,h);var T,E,F,O=function(t){if(t===f&&k)return k;if(!b&&t in P)return P[t];switch(t){case _:case m:case g:return function(){return new r(this,t)}}return function(){return new r(this)}},A=e+" Iterator",x=!1,P=t.prototype,R=P[y]||P["@@iterator"]||f&&P[f],k=!b&&R||O(f),I="Array"==e&&P.entries||R;if(I&&(T=l(I.call(new t)),p!==Object.prototype&&T.next&&(c||l(T)===p||(n?n(T,p):"function"!=typeof T[y]&&o(T,y,v)),a(T,A,!0,!0),c&&(d[A]=v))),f==m&&R&&R.name!==m&&(x=!0,k=function(){return R.call(this)}),c&&!S||P[y]===k||o(P,y,k),d[e]=k,f)if(E={values:O(m),keys:L?k:O(_),entries:O(g)},S)for(F in E)(b||x||!(F in P))&&u(P,F,E[F]);else i({target:e,proto:!0,forced:b||x},E);return E}},(t,e,r)=>{var i=r(10),s=r(48).f,l=r(15),n=r(50),a=r(14),o=r(51),u=r(55);t.exports=function(t,e){var r,h,c,d,f,p=t.target,b=t.global,y=t.stat;if(r=b?i:y?i[p]||a(p,{}):(i[p]||{}).prototype)for(h in e){if(d=e[h],c=t.noTargetGet?(f=s(r,h))&&f.value:r[h],!u(b?h:p+(y?".":"#")+h,t.forced)&&void 0!==c){if(typeof d==typeof c)continue;o(d,c)}(t.sham||c&&c.sham)&&l(d,"sham",!0),n(r,h,d,t)}}},(t,e,r)=>{var i=r(16),s=r(49),l=r(23),n=r(3),a=r(22),o=r(24),u=r(18),h=Object.getOwnPropertyDescriptor;e.f=i?h:function(t,e){if(t=n(t),e=a(e,!0),u)try{return h(t,e)}catch(r){}if(o(t,e))return l(!s.f.call(t,e),t[e])}},(t,e)=>{"use strict";var r={}.propertyIsEnumerable,i=Object.getOwnPropertyDescriptor,s=i&&!r.call({1:2},1);e.f=s?function(t){var e=i(this,t);return!!e&&e.enumerable}:r},(t,e,r)=>{var i=r(10),s=r(15),l=r(24),n=r(14),a=r(45),o=r(43),u=o.get,h=o.enforce,c=String(String).split("String");(t.exports=function(t,e,r,a){var o,u=!!a&&!!a.unsafe,d=!!a&&!!a.enumerable,f=!!a&&!!a.noTargetGet;"function"==typeof r&&("string"!=typeof e||l(r,"name")||s(r,"name",e),(o=h(r)).source||(o.source=c.join("string"==typeof e?e:""))),t!==i?(u?!f&&t[e]&&(d=!0):delete t[e],d?t[e]=r:s(t,e,r)):d?t[e]=r:n(e,r)})(Function.prototype,"toString",(function(){return"function"==typeof this&&u(this).source||a(this)}))},(t,e,r)=>{var i=r(24),s=r(52),l=r(48),n=r(17);t.exports=function(t,e){for(var r=s(e),a=n.f,o=l.f,u=0;u<r.length;u++){var h=r[u];i(t,h)||a(t,h,o(e,h))}}},(t,e,r)=>{var i=r(39),s=r(53),l=r(54),n=r(21);t.exports=i("Reflect","ownKeys")||function(t){var e=s.f(n(t)),r=l.f;return r?e.concat(r(t)):e}},(t,e,r)=>{var i=r(31),s=r(37).concat("length","prototype");e.f=Object.getOwnPropertyNames||function(t){return i(t,s)}},(t,e)=>{e.f=Object.getOwnPropertySymbols},(t,e,r)=>{var i=r(5),s=/#|\.prototype\./,l=function(t,e){var r=a[n(t)];return r==u||r!=o&&("function"==typeof e?i(e):!!e)},n=l.normalize=function(t){return String(t).replace(s,".").toLowerCase()},a=l.data={},o=l.NATIVE="N",u=l.POLYFILL="P";t.exports=l},(t,e,r)=>{"use strict";var i=r(57).IteratorPrototype,s=r(28),l=r(23),n=r(61),a=r(42),o=function(){return this};t.exports=function(t,e,r){var u=e+" Iterator";return t.prototype=s(i,{next:l(1,r)}),n(t,u,!1,!0),a[u]=o,t}},(t,e,r)=>{"use strict";var i,s,l,n=r(5),a=r(58),o=r(15),u=r(24),h=r(9),c=r(12),d=h("iterator"),f=!1;[].keys&&("next"in(l=[].keys())?(s=a(a(l)))!==Object.prototype&&(i=s):f=!0);var p=null==i||n((function(){var t={};return i[d].call(t)!==t}));p&&(i={}),c&&!p||u(i,d)||o(i,d,(function(){return this})),t.exports={IteratorPrototype:i,BUGGY_SAFARI_ITERATORS:f}},(t,e,r)=>{var i=r(24),s=r(59),l=r(41),n=r(60),a=l("IE_PROTO"),o=Object.prototype;t.exports=n?Object.getPrototypeOf:function(t){return t=s(t),i(t,a)?t[a]:"function"==typeof t.constructor&&t instanceof t.constructor?t.constructor.prototype:t instanceof Object?o:null}},(t,e,r)=>{var i=r(7);t.exports=function(t){return Object(i(t))}},(t,e,r)=>{var i=r(5);t.exports=!i((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype}))},(t,e,r)=>{var i=r(17).f,s=r(24),l=r(9)("toStringTag");t.exports=function(t,e,r){t&&!s(t=r?t:t.prototype,l)&&i(t,l,{configurable:!0,value:e})}},(t,e,r)=>{var i=r(21),s=r(63);t.exports=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set).call(r,[]),e=r instanceof Array}catch(l){}return function(r,l){return i(r),s(l),e?t.call(r,l):r.__proto__=l,r}}():void 0)},(t,e,r)=>{var i=r(20);t.exports=function(t){if(!i(t)&&null!==t)throw TypeError("Can't set "+String(t)+" as a prototype");return t}},(t,e,r)=>{var i=r(10),s=r(65),l=r(2),n=r(15),a=r(9),o=a("iterator"),u=a("toStringTag"),h=l.values;for(var c in s){var d=i[c],f=d&&d.prototype;if(f){if(f[o]!==h)try{n(f,o,h)}catch(b){f[o]=h}if(f[u]||n(f,u,c),s[c])for(var p in l)if(f[p]!==l[p])try{n(f,p,l[p])}catch(b){f[p]=l[p]}}}},t=>{t.exports={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0}},(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>a});var i=r(67),s=r(68);let l=0;class n extends Phaser.GameObjects.Sprite{constructor(t,e,r,s,n){super(t,e,r,s,n),this.body=void 0,this.bulletID=void 0,this.lifespan=void 0,this.bulletID=l,l++,this.scene.physics.add.existing(this),this.setDataEnabled(),this.setData({timeEvent:void 0,bulletManager:void 0,fromX:0,fromY:0,bodyDirty:!0,rotateToVelocity:!1,killType:i.KillType.KILL_NEVER,killDistance:0,bodyBounds:new Phaser.Geom.Rectangle})}setData(t,e){return super.setData(t,e)}getData(t){return super.getData(t)}prepare(t,e){var r;this.setActive(!0),this.setVisible(!0),this.body.enable=!0,this.body.reset(t,e);const i=(null===(r=this.getData("bulletManager"))||void 0===r?void 0:r.debugPhysics)||!1;this.body.debugShowBody=i,this.body.debugShowVelocity=i}kill(){var t;this.body.stop(),this.body.enable=!1,this.setActive(!1),this.setVisible(!1),this.body.debugShowBody=!1,this.body.debugShowVelocity=!1;const e=this.getData("timeEvent");return void 0!==e&&(e.destroy(),this.setData("timeEvent",void 0)),null===(t=this.getData("bulletManager"))||void 0===t||t.emit(s.BULLET_KILL,this,this.getData("bulletManager")),this}update(){if(!this.active)return;const t=this.getData("bulletManager");this.getData("killType")>i.KillType.KILL_LIFESPAN&&(this.getData("killType")===i.KillType.KILL_DISTANCE?new Phaser.Math.Vector2(this.getData("fromX"),this.getData("fromY")).distance(this)>this.getData("killDistance")&&this.kill():Phaser.Geom.Intersects.RectangleToRectangle(t.bulletBounds,this.body.getBounds(this.getData("bodyBounds")))||this.kill()),this.getData("rotateToVelocity")&&(this.rotation=Math.atan2(this.body.velocity.y,this.body.velocity.x)),t.bulletWorldWrap&&this.scene.physics.world.wrap(this,t.bulletWorldWrapPadding)}}const a=n},(t,e,r)=>{"use strict";var i,s,l;r.r(e),r.d(e,{KillType:()=>i,Angle:()=>s,FrameType:()=>l,default:()=>n}),function(t){t[t.KILL_NEVER=0]="KILL_NEVER",t[t.KILL_LIFESPAN=1]="KILL_LIFESPAN",t[t.KILL_DISTANCE=2]="KILL_DISTANCE",t[t.KILL_WEAPON_BOUNDS=3]="KILL_WEAPON_BOUNDS",t[t.KILL_CAMERA_BOUNDS=4]="KILL_CAMERA_BOUNDS",t[t.KILL_WORLD_BOUNDS=5]="KILL_WORLD_BOUNDS",t[t.KILL_STATIC_BOUNDS=6]="KILL_STATIC_BOUNDS"}(i||(i={})),function(t){t[t.ANGLE_UP=270]="ANGLE_UP",t[t.ANGLE_DOWN=90]="ANGLE_DOWN",t[t.ANGLE_LEFT=180]="ANGLE_LEFT",t[t.ANGLE_RIGHT=0]="ANGLE_RIGHT",t[t.ANGLE_NORTH_EAST=315]="ANGLE_NORTH_EAST",t[t.ANGLE_NORTH_WEST=225]="ANGLE_NORTH_WEST",t[t.ANGLE_SOUTH_EAST=45]="ANGLE_SOUTH_EAST",t[t.ANGLE_SOUTH_WEST=135]="ANGLE_SOUTH_WEST"}(s||(s={})),function(t){t[t.BULLET_FRAME_STABLE=0]="BULLET_FRAME_STABLE",t[t.BULLET_FRAME_CYCLE=1]="BULLET_FRAME_CYCLE",t[t.BULLET_FRAME_RANDOM=2]="BULLET_FRAME_RANDOM"}(l||(l={}));const n={KillType:i,Angle:s,FrameType:l}},(t,e,r)=>{"use strict";r.r(e),r.d(e,{WEAPON_FIRE:()=>i,WEAPON_FIRE_LIMIT:()=>s,BULLET_KILL:()=>l,default:()=>n});const i="fire",s="firelimit",l="kill",n={WEAPON_FIRE:i,WEAPON_FIRE_LIMIT:s,BULLET_KILL:l}},(t,e,r)=>{"use strict";r.r(e),r.d(e,{log:()=>s,default:()=>l});var i=r(67);function s(t,e){if("warn"===e)console.warn(t);else if("error"===e)throw new Error(t)}const l=function(t,e="all"){var r,l;!["bulletWorldWrap","bulletKillType"].includes(e)&&"all"!==e||!t.bulletWorldWrap||t.bulletKillType!==i.default.KillType.KILL_WORLD_BOUNDS&&t.bulletKillType!==i.default.KillType.KILL_WEAPON_BOUNDS||s("Warning: KILL_WORLD_BOUNDS and KILL_WEAPON_BOUNDS does not work well with bulletWorldWrap set to true.",t.logLevel),(["bulletKillType","bulletLifespan"].includes(e)||"all"===e)&&t.bulletKillType===i.default.KillType.KILL_LIFESPAN&&t.bulletLifespan<0&&s("Invalid bulletLifespan; must be > 0; currently "+t.bulletLifespan,t.logLevel),!["trackRotation","trackedSprite"].includes(e)&&"all"!==e||!0!==t.trackRotation||void 0!==(null===(r=t.trackedSprite)||void 0===r?void 0:r.rotation)&&void 0!==t.trackedSprite.angle||s("Warning: Weapon cannot track rotation of an object without a rotation and/or angle property.",t.logLevel),!["bulletInheritSpriteSpeed","trackedSprite"].includes(e)&&"all"!==e||!0!==t.bulletInheritSpriteSpeed||null!==(l=t.trackedSprite)&&void 0!==l&&l.body||s("Warning: Bullet cannot inherit speed from a sprite without a body.",t.logLevel);const n=["fireLimit","fireRate","fireRateVariance","bulletAngleVariance","bulletSpeedVariance","bulletKillDistance"];"all"===e?n.forEach((r=>{void 0!==t[r]&&t[r]<0&&s("Invalid "+e+"; must be >= 0; currently "+t[r],t.logLevel)})):n.includes(e)&&void 0!==t[e]&&t[e]<0&&s("Invalid "+e+"; must be >= 0; currently "+t[e],t.logLevel)}},(t,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>l});var i=r(1);class s extends Phaser.Plugins.ScenePlugin{constructor(t,e){super(t,e),this.weapons=void 0,this.weapons=[],e.registerGameObject("weapon",this.add.bind(this),(t=>this.add(t.bulletLimit,t.key,t.frame,t.group,t.weaponClass)))}add(t,e,r,s,l=i.default){const n=new l(this.scene,t,e,r,s);return this.weapons.push(n),n}start(){this.systems.events.on(Phaser.Core.Events.POST_RENDER,this.postRender,this)}boot(){const t=this.systems.events;t.on(Phaser.Scenes.Events.UPDATE,this.update,this),t.on(Phaser.Core.Events.DESTROY,this.destroy,this)}update(){this.weapons.forEach((t=>{t.update()}))}postRender(){this.weapons.forEach((t=>{t.postRender()}))}destroy(){super.destroy(),this.weapons.forEach((t=>{t.destroy()}))}}const l=s}],e={};function r(i){if(e[i])return e[i].exports;var s=e[i]={exports:{}};return t[i](s,s.exports,r),s.exports}return r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var i in e)r.o(e,i)&&!r.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r(0)})()}));
//# sourceMappingURL=WeaponPlugin.min.js.map